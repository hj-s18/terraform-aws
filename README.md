# Route53 (프라이빗 호스팅 영역) CNAME 확인
![route53](https://github.com/user-attachments/assets/e8726aa9-2af4-42e1-83de-06e408d8eea8)

<br>
<br>
<br>

# Bastion Host 에서 Route53 CNAME 사용하여 RDS 접근 실패

```
# Bastion 인스턴스에서 RDS 접근 실패
[ec2-user@ip-10-0-1-230 ~]$ mysql -u admin -h rds.tf.private.com -p'<password>'
ERROR 2005 (HY000): Unknown MySQL server host 'rds.tf.private.com' (2)

# 현재 EC2 인스턴스가 사용 중인 DNS 서버 확인 ⇒ 10.0.0.2를 DNS 서버로 사용중
[ec2-user@ip-10-0-1-99 ~]$ cat /etc/resolv.conf
; generated by /usr/sbin/dhclient-script
search ap-northeast-2.compute.internal
options timeout:2 attempts:5
nameserver 10.0.0.2

# 특정 DNS 서버(10.0.0.2)를 사용하여 도메인 이름(rds.tf.private.com) 조회 ⇒ 도메인 이름의 IP 주소를 조회하여 반환
# DNS 서버가 rds.tf.private.com을 모르면 응답이 없거나 NXDOMAIN(존재하지 않음) 오류 발생
[ec2-user@ip-10-0-1-99 ~]$ nslookup rds.tf.private.com 10.0.0.2
Server:         10.0.0.2
Address:        10.0.0.2#53

** server can't find rds.tf.private.com: NXDOMAIN
```

<br>
<br>
<br>

# Route53 Private Hosted Zone 사용 조건
VPC 내에서 Private Hosted Zone을 사용하려면 DNS 해석(DNS Resolution) 및 DNS 호스트네임(DNS Hostnames) 설정 필요 <br>
⇒ VPC 설정에서 DNS 호스트 이름 활성화

<br>
<br>
<br>

# Bastion Host 에서 Route53 CNAME 사용하여 RDS 접근 성공

```
# 10.0.0.2에 설정된 DNS 서버가 rds.tf.private.com의 IP 주소 조회하여 반환 가능
[ec2-user@ip-10-0-1-99 ~]$ nslookup rds.tf.private.com 10.0.0.2
Server:         10.0.0.2
Address:        10.0.0.2#53

Non-authoritative answer:
rds.tf.private.com      canonical name = <RDS 엔드포인트>.
Name:   <RDS 엔드포인트>
Address: 10.0.6.213

# Bastion 인스턴스에서 RDS 접근 성공
[ec2-user@ip-10-0-1-99 ~]$ mysql -u admin -h rds.tf.private.com -p'<password>'
Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MySQL connection id is 37
Server version: 8.0.40 Source distribution

Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

MySQL [(none)]> exit
Bye

[ec2-user@ip-10-0-1-99 ~]$
```

<br>
<br>
<br>
